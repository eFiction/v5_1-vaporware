	<h4>
		<a href="{{@BASE}}/story/read/{{@story.sid}}">{{@story.title}}</a><br />
		{{@LN__by}} <repeat group="{{@story.cache_authors}}" value="{{@author}}" counter="{{ @i }}">
			<check if="{{ @i>1 }}">, </check>
			<check if="{{ @_SESSION.userID == @author[0] }}"><set no_review="1" /></check>
		<a href="{{@BASE}}/members/{{@author[1]}}">{{@author[1]}}</a>
		</repeat>
	</h4>

<script type="text/javascript">
			$(function() {
				$('#comments-container').comments({
					profilePictureURL: '',
					currentUserId: 1,
					roundProfilePictures: true,
					textareaRows: 1,
					enableAttachments: false,
					enableHashtags: false,
					enablePinging: false,
					enableNavigation: false,
					enableUpvoting: false,
					scrollContainer: $(window),
					searchUsers: function(term, success, error) {
						success([]);
					},
					getComments: function(success, error) {
						setTimeout(function() {
						$.ajax({
							type: 'POST',
							url: '{{@BASE}}/story/ajax/getreviews',
							data: { sid: {{@story.sid}}<check if="isset(@story.chapid)">, chapid: {{@story.chapid}}</check> },
							datatype: 'JSON',
							success: function(commentsArray2) {
								comments = JSON.parse(commentsArray2);
								parser = new DOMParser();
								comments.forEach(function(item,index,arr) {
									arr[index]['content'] = parser.parseFromString(arr[index]['content'],'text/html').documentElement.textContent;
								});
								success(comments);
							},
							error: error
						});
						}, 500);
					},
					postComment: function(data, success, error) {
						setTimeout(function() {
							success(saveComment(data));
						}, 500);
					},
					postComment: function(commentJSON, success, error) {
						$.ajax({
						  type: 'POST',
						  url: '{{@BASE}}/story/ajax/postreview',
						datatype: 'JSON',
						  data: commentJSON,
						  success: function(comment) {
							alert(comment);
							success(comment)
						  },
						  error: error
						});
					},
					putComment: function(data, success, error) {
						setTimeout(function() {
							success(saveComment(data));
						}, 500);
					},
					deleteComment: function(data, success, error) {
						setTimeout(function() {
							success();
						}, 500);
					},
				});
			});
		</script>

<div id="comments-container"></div>